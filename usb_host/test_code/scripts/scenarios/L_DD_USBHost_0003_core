###############################################################################
# Scenario: L_DD_USBHost_0003_core
# Author  : Axel Castaneda Gonzalez
# Date    : December 4, 2006
# Description:  Running test.sh (Chapter 9) using 'usbtest' on high-speed devices
# ChangeLog:
#	6 Feb 2009 - Diego Zavala Trujillo - Updating scenario from Host.
################################################################################

foo	echo L_DD_USBHost_0003_core

1  echo -e '\n\n\t Linux PC: Loading net2280 module. \n\n'; export MODULE="net2280"  &&  $TESTSCRIPT/enum.sh insertRemoteModule  &&  exit 0 || exit 1

2  echo -e '\n\n\t Linux PC: Loading g_zero module. \n\n'; export MODULE="g_zero"  &&  $TESTSCRIPT/enum.sh insertRemoteModule  &&  exit 0 || exit 1

3  echo -e '\n\n\t Connect cable (Net2280 Std B - miniA OMAP)  \n\n'  &&  sleep $DELAY2  &&  exit 0 || exit 1

### Checking Enumeration
4  echo -e '\n\n\t Checking enumeration. \n\n'  &&  export ENUM_INFO="Gadget Zero"; $TESTSCRIPT/enum.sh connectDevice  &&  exit 0 || exit 1

### Running  the control transfer tests
5  if [ "$ACTION" = "c" ]; then (echo "$LOGBASE/log.testControlOMAP" > $LOGBASE/log.tmp; $TESTSCRIPT/enum.sh testc  &&  exit 0  || exit 0); elif [ "$ACTION" = "io" ]; then (echo "$LOGBASE/log.testInOutOMAP" > $LOGBASE/log.tmp; $TESTSCRIPT/enum.sh testio  &&  exit 0  || exit 0); elif [ "$ACTION" = "cio" ]; then (echo "$LOGBASE/log.testControlInOutOMAP" > $LOGBASE/log.tmp; $TESTSCRIPT/enum.sh testcio  &&  exit 0  || exit 0) fi

6  set -x; (TMP=`cat $LOGBASE/log.tmp` && cat $TMP | grep "FAIL")  &&  echo -e "\n\n\t ERROR-4 - Found an error on the test ${COMMAND}. \n\n" &&  exit 1 || echo -e "\n\n\t Ok \n\n" && exit 0
7  set -x; (TMP=`cat $LOGBASE/log.tmp` && cat $TMP | grep "error") &&  echo -e "\n\n\t ERROR-4 - Found an error on the test ${COMMAND}. \n\n" &&  exit 1 || echo -e "\n\n\t Ok \n\n" && exit 0
8  set -x; (TMP=`cat $LOGBASE/log.tmp` && cat $TMP | grep "pipe")  &&  echo -e "\n\n\t ERROR-4 - Found a pipe on the test ${COMMAND}. \n\n"  &&  exit 1 || echo -e "\n\n\t Ok \n\n"  &&  exit 0

9  echo -e '\n\n\t Linux PC: Removing g_zero module. \n\n'  &&  export MODULE="g_zero"  &&  $TESTSCRIPT/enum.sh removeRemoteModule  && exit 0 || exit 1

10 echo -e '\n\n\t Linux PC: Removing net2280 module. \n\n'  &&  export MODULE="net2280"  &&  $TESTSCRIPT/enum.sh removeRemoteModule  && exit 0 || exit 1

bar	echo L_DD_USBHost_0003_core
