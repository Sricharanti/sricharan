################################################################################
# Scenario: L_DD_USBEHCI_0009
# Author  : Axel Castaneda Gonzalez
# Date    : January  4, 2006
# Description: Testing the suspend and resume functionality of the USB EHCI
#	controller. Cable switching after a suspend and resume cycle.
# Changelog:
#	10 Feb 2009 - Diego Zavala Trujillo - Update instructions.
################################################################################

foo	echo 'L_DD_USBEHCI_0009'

0  set -x; insmod $MODULE_PATH/ehci-hcd.ko  &&  echo -e "\n\n\t Testing the Suspend and Resume functionality of the USB EHCI controller. \n\t Cable switching after a suspend and resume cycle. \n\n" &&  sleep $DELAY1  &&  echo "0" > $LOGBASE/log.panresult; exit 0 || echo -e "\n\n\t ERROR1 - No module found. \n\n"; echo "1" > $LOGBASE/log.panresult; exit 1

1  if [ `cat $LOGBASE/log.panresult` = 0 ]; then echo on > $ECHI_LEVEL  &&  echo -e "\n\n\t Turning on the echi device \n\n"  &&  exit 0 || exit 1; else echo -e "\n\n\t ERROR1 - Could not run this test because the module has not been inserted. \n\n"; exit 1; fi

2  if [ `cat $LOGBASE/log.panresult` = 0 ]; then ${TESTROOT}/test_runner.sh -p L_DD_USBEHCI_0009_core  &&  exit 0 || exit 1; else echo -e "\n\n\t ERROR1 - Could not run this test because the module has not been inserted. \n\n"; exit 1; fi

3  rmmod ehci-hcd.ko && exit 0 || exit 1

bar	echo 'L_DD_USBEHCI_0009'
