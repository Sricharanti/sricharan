################################################################################
# Scenario: L_DD_USBDevice_0003_1
# Author  : Axel Castaneda Gonzalez
# Date    : December 4, 2006
# Description: 'usbtest' test suit. (Gadget Zero)
# ChangeLog:
#	27 Jan 2009 - Diego Zavala Trujillo - Update Scenario.
#		Chage the struture, adding enum.sh script.
################################################################################

foo	echo L_DD_USBDevice_0003_1

0	insmod $MODULE_PATH/g_zero.ko  &&  echo -e "\n\n\t Testing "usbtest" suite. \n\n\t Please connect cable [ MiniA to OMAP -Std-A to Linux PC ]."   &&  sleep $DELAY1  &&  echo "0" > $LOGBASE/log.panresult  &&  exit 0  || echo -e "\n\n\t ERROR1 - No module found. \n\n"; echo "1" > $LOGBASE/log.panresult  &&  exit 1

### Functional test

1	if [ `cat $LOGBASE/log.panresult` = 0 ]; then export MODE="Device"; export ACTION="cio"; export COMMAND="control in out"; export MESSAGE="Testing Control In Out Transfers"; ${TESTROOT}/test_runner.sh -p L_DD_USBDevice_0003_core  && exit 0 || exit 1; else echo -e "\n\n\t ERROR1 - Could not run this test because the module has not been inserted. \n\n"; exit 1; fi

#1a	if [ `cat $LOGBASE/log.panresult` = 0 ]; then export MODE="Device"; export ACTION="c"; export COMMAND="control"; export MESSAGE="Testing Control Transfers"; ${TESTROOT}/test_runner.sh -p L_DD_USBDevice_0003_core  && exit 0 || exit 1; else echo -e "\n\n\t ERROR1 - Could not run this test because the module has not been inserted. \n\n"; exit 1; fi

#1b	if [ `cat $LOGBASE/log.panresult` = 0 ]; then export MODE="Device"; export ACTION="io"; export COMMAND="in out"; export MESSAGE="Testing In Out Transfers"; ${TESTROOT}/test_runner.sh -p L_DD_USBDevice_0003_core  && exit 0 || exit 1; else echo -e "\n\n\t ERROR1 - Could not run this test because the module has not been inserted. \n\n"; exit 1; fi

2	echo -e '\n\n\t Disconnect cable. \n\n'  &&  sleep $DELAY2; set -x; rm -rf $LOGBASE/log.panresult; rmmod g_zero  &&  exit 0 || exit 1

bar	echo L_DD_USBDevice_0003_1
