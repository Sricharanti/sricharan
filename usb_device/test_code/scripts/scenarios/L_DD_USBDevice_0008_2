###################################################################################################################
# Scenario: L_DD_USBDevice_0008
# Author  : Axel Casta¤eda Gonzalez
# Date    : June 26, 2007
# Description:  Functional test for file-storage gadget using Windows PC host.
###################################################################################################################

foo	echo L_DD_USBDevice_0008_2

#0	echo -e "\n\n\t Creating a 4 Mb file to use it with the g_file_storage module. \n\n"  &&  $TESTSCRIPT/enum.sh createvFat  && exit 0 || exit 1

1	insmod $MODULE_PATH/g_file_storage.ko file=$VFAT_FILE stall=0  &&  echo -e "\n\n\t Testing File Storage Gadget functionality on a Windows PC. \n\n " &&  sleep $DELAY1  &&  echo "0" > $LOGBASE/log.panresult  &&  exit 0  || echo -e "\n\n\t ERROR1 - No module found. \n\n"; echo "1" > $LOGBASE/log.panresult  &&  exit 1

2	if [ `cat $LOGBASE/log.panresult` = 0 ]; then export MACHINE="WindowsPC"; echo -e "\n\n\t Please connect cable. [ MiniB to OMAP - Std-A to WindowsPC ] \n "  &&  sleep $DELAY4  &&  ${TESTROOT}/test_runner.sh -p L_DD_USBDevice_0008_core  &&  exit 0 || exit 1; else echo -e "\n\n\t ERROR1 - Could not run this test because the module has not been inserted. \n\n"; exit 1; fi

#3	echo -e "\n\n\t Delleting the 4 Mb file. \n\n"  &&  $TESTSCRIPT/enum.sh dellvFat  && exit 0 || exit 1

4	rm -rf $LOGBASE/log.panresult; rmmod g_file_storage && exit 0 || exit 1

bar	echo L_DD_USBDevice_0008_2
