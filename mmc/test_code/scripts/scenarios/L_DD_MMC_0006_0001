###################################################################################################################
# Scenario: L_DD_MMC_0006_0001
# Author  : Misael Lopez Cruz
# Date    : September 20, 2006
# Description: Test for booting the device with a root file system on the SD card
###################################################################################################################

# Begin L_DD_MMC_0006_0001

01 set -x; mkdir $MOUNT_POINT1; mkdir $MOUNT_POINT3; exit 0
02 set -x; echo -e "n\n p\n 1\n $START_SECTOR_DEV1\n $END_SECTOR_DEV1\n w\n" | fdisk $ROOT_ENTRY_DEV1 && exit 0 || exit 1

03 set -x; $TESTBIN/mke2fs $PARTITION1_ENTRY_DEV1 && exit 0 || exit 1

04 set -x; mount -t ext2 $PARTITION1_ENTRY_DEV1 $MOUNT_POINT1 && exit 0 || exit 1
05 set -x; mount | grep $PARTITION1_ENTRY_DEV1 | grep "ext2" && exit 0 || exit 1

06 set -x; echo > /var/log/dmesg && exit 0 || exit 1
07 set -x; cp -r /bin /etc /dev /include /lib $MOUNT_POINT1 && sync; exit 0
08 set -x; cp -r /sbin /share /usr /var $MOUNT_POINT1 && sync; exit 0
09 set -x; mkdir $MOUNT_POINT1/proc $MOUNT_POINT1/sys && sync && exit 0 || exit 1
10 set -x; mkdir $MOUNT_POINT1/tmp $MOUNT_POINT1/root && sync && exit 0 || exit 1

11 set -x; umount $MOUNT_POINT1 && exit 0 || exit 1

12 echo; echo "<<< setenv bootargs console=ttyS0,115200n8 noinitrd root=/dev/mmcblk0p1 rootfstype=ext2 >>>"; echo;

# End L_DD_MMC_0006_0001
