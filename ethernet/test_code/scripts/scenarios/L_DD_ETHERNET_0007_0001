################################################################################
# Scenario: L_DD_ETHERNET_0007_0001
# Author  : Cristopherson Torres
# Date    : Fri Mar 28 13:59:10 CDT 2008
################################################################################

# Begin L_DD_ETHERNET_0007_0001

# Checking the current setup
01 set -x; if [ "$IPADDR" == "" ]; then echo "FATAL: IPADDR is not set"; exit 1; fi; exit 0
02 set -x; if [ "$HOST_MOUNT_POINT" == "" ]; then echo "FATAL: HOST_MOUNT_POINT is not set"; exit 1; fi; exit 0

# Validating the scenario
03 set -x; mkdir -p $MOUNT_POINT || echo "Folder is already created" && exit 0 || exit 1
04 set -x; mount | grep nfs && exit 1 || exit 0
05 set -x; mount -o nolock -t nfs $IPADDR:$HOST_MOUNT_POINT $MOUNT_POINT && exit 0 || exit 1
06 set -x; mount | grep nfs && exit 0 || exit 1
07 set -x; ls $MOUNT_POINT/testfile && exit 1 || exit 0
08 set -x; date > $TMPBASE/testfile; cp $TMPBASE/testfile $MOUNT_POINT/testfile && exit 0 || exit 1
09 set -x  ls $MOUNT_POINT/testfile && exit 0 || exit 1
10 set -x; umount $MOUNT_POINT && exit 0 || exit 1
11 set -x; ls $MOUNT_POINT/testfile && exit 1 || exit 0
12 set -x; mount -o nolock -t nfs $IPADDR:$HOST_MOUNT_POINT $MOUNT_POINT && exit 0 || exit 1
13 set -x; ls $MOUNT_POINT/testfile && cmp $MOUNT_POINT/testfile $TMPBASE/testfile && exit 0 || exit 1
14 set -x; rm $MOUNT_POINT/testfile && exit 0 || exit 1
15 set -x; umount $MOUNT_POINT && exit 0 || exit 1
16 set -x; mount -o nolock -t nfs $IPADDR:$HOST_MOUNT_POINT $MOUNT_POINT && exit 0 || exit 1
17 set -x; ls $MOUNT_POINT/testfile && exit 1 || exit 0
18 set -x; umount $MOUNT_POINT && exit 0 || exit 1

# End L_DD_ETHERNET_0007_0001
