###############################################################################
# Scenario: L_DD_POWER_0008_0002
# Author : Andrii Danylov
# Test for Smart Reflex disable:
# For each VDD OPP, enable Smart Reflex. Probe the corresponding VDD voltage
# and make sure VDD scales down after SR is enabled.
# Then disable Smart Reflex. Voltage should go back to Nominal Voltage.
###############################################################################

# Begin L_DD_POWER_0008_0002

# Iterate for a period of time over all the available frequencies
0000 set -x; handlerCpuFreqScalFrequencies.sh run "OPP1" "sleep 1"

# Disable SmartRelfex for all domains
0001 set -x; handlerSmartReflex.sh enable all

0002 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mpu"
0003 set -x; handlerVoltageTransitionsStats.sh compare "vdd_core"
0004 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mm"

# Enable SmartRelfex for all domains
0005 set -x; handlerSmartReflex.sh disable all

0006 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mpu"
0007 set -x; handlerVoltageTransitionsStats.sh compare "vdd_core"
0008 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mm"


# Iterate for a period of time over all the available frequencies
0010 set -x; handlerCpuFreqScalFrequencies.sh run "OPP2" "sleep 1"

# Disable SmartRelfex for all domains
0011 set -x; handlerSmartReflex.sh enable all

0012 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mpu"
0013 set -x; handlerVoltageTransitionsStats.sh compare "vdd_core"
0014 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mm"

# Enable SmartRelfex for all domains
0015 set -x; handlerSmartReflex.sh disable all

0016 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mpu"
0017 set -x; handlerVoltageTransitionsStats.sh compare "vdd_core"
0018 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mm"

# Iterate for a period of time over all the available frequencies
0020 set -x; handlerCpuFreqScalFrequencies.sh run "OPP3" "sleep 1"

# Disable SmartRelfex for all domains
0021 set -x; handlerSmartReflex.sh enable all

0022 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mpu"
0023 set -x; handlerVoltageTransitionsStats.sh compare "vdd_core"
0024 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mm"

# Enable SmartRelfex for all domains
0025 set -x; handlerSmartReflex.sh disable all

0026 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mpu"
0027 set -x; handlerVoltageTransitionsStats.sh compare "vdd_core"
0028 set -x; handlerVoltageTransitionsStats.sh compare "vdd_mm"

# End L_DD_POWER_0008_0002
